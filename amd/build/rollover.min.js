define([],function(){var a="*",b="",c=$("#rollovercontainer").attr("data-id"),d=function(){$("#rollovercontainer").html("<p>Something went wrong! Please refresh and try again or contact your FLT.</p>")},e=function(a){$.ajax({url:M.cfg.wwwroot+"/course/format/standardweeks/ajax/rollover.php",type:"POST",data:{courseid:c,action:"status",sesskey:M.cfg.sesskey},success:a})},f=function(){e(function(a){var b=a.progress,e=a.status;return"rollover_error"==e?void d():("rollover_complete"==e&&(window.location=M.cfg.wwwroot+"/course/view.php?id="+c,e="Rollover complete!"),b>-1&&$("#rollovercontainer .progress-bar").attr("aria-valuenow",b).css("width",b+"%"),$("#rollovercontainer .progress-bar").html(e),void setTimeout(function(){f()},1e4))})},g=function(){$("#rollovercontainer").html('            <p>Please wait... your course is being rolled over.<br />Note: you can safely close this page and check back later.</p>            <div class="progress">                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">                    <i class="fa fa-spin fa-spinner"></i>                </div>            </div>        '),f()},h=function(){b.length<2||$.ajax({url:M.cfg.wwwroot+"/course/format/standardweeks/ajax/rolloversources.php",type:"GET",data:{to:c,dist:a,search:b,sesskey:M.cfg.sesskey}}).done(function(a){$("#rollover-options").html(a.result),$("#rollover-options td.action button").on("click",function(a){a.preventDefault();var b=$(this).attr("data-id");return $("#rollovercontainer").html('<div class="text-center"><i class="fa fa-spinner fa-spin"></i></div>'),$.ajax({url:M.cfg.wwwroot+"/course/format/standardweeks/ajax/rollover.php",type:"POST",data:{to:c,from:b,action:"schedule",sesskey:M.cfg.sesskey},success:function(a){return"undefined"==typeof a.rolloverid?void d():void g()}}),!1})})};return{init:function(){$("#moodle-select a").on("click",function(b){return b.preventDefault(),$("#moodle-select").dropdown("toggle"),a=$(this).attr("data-name"),$("#moodle-select-button").html($(this).text()+' <span class="caret"></span>'),h(),!1}),$("#moodle-search").on("keyup",function(){b=$(this).val(),h()}),$("#currentrollover").length>0&&g()}}});